<div xmlns:py="http://genshi.edgewall.org/"
     py:with="action_url = request_uri('parent_id=%i' % group.get_id());
              img_dir    = plugin_dir + '/img/'"
     py:strip="True">
<form action="${action_url}" method="post">
<table class="container" width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td width='230' valign="top">
    <table class="menu" cellpadding="0">
      <tr><td align='center'><i py:content="txt('Members')" /></td></tr>
      <py:for each="item in groups">
        <tr>
          <td py:with="url = request_uri('parent_id=%i&amp;id=%i' % (group.get_id(), item.get_id()))">
          <a href="$url"><img src="${img_dir}/group.png" alt="Group:" /><span py:content="item.get_name()" /></a>
          <span py:content="'(%i)' % item.get_n_children()" />
          </td>
        </tr>
      </py:for>
      <div py:if="groups and users" class='seperator'></div>
      <py:for each="item in users">
        <tr>
          <td py:with="url = request_uri('parent_id=%i&amp;id=%i' % (group.get_id(), item.get_id()))">
          <a href="$url"><img src="${img_dir}/user.png" alt="User:" /><span py:content="item.get_name()" /></a>
          <span py:content="'(%i)' % item.get_n_children()" />
          </td>
        </tr>
      </py:for>
    </table>
    </td>
    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>
    <td width='100%'>
    <py:choose>
      <h2 py:when="group.get_id() == 0" py:content="txt('Create A New Group')" />
      <h2 py:otherwise="" py:content="group.get_name()" />
    </py:choose>
    <h3 py:content="txt('Public Group Information')" />
    <table class="indent" width="100%" cellpadding="0" cellspacing="5">
      <tr>
        <td class="nowrap" py:content="txt('Group Name:')" />
        <td width="100%"><input type="text" class="field" name="name" value="${group.get_name()}" /></td>
      </tr>
      <tr>
        <td class="nowrap" valign="top" py:content="txt('Description:')" />
        <td width="100%">
          <textarea name="description"
                    rows="3"
                    cols="80"
                    py:content="group.get_attribute('description')" />
        </td>
      </tr>
    </table>

    <h3 py:content="txt('Defaults')" />
    <table class="indent" cellpadding="0">
      <tr>
        <td py:content="txt('Content created by users in this group is by default owned by:')" />
        <td>
        <select name="use_group_rights"
                py:with="group_rights = group.get_attribute('use_group_rights')">
          <option py:attrs="dict(selected=(None, 'selected')[group_rights])"
                  value="1"
                  py:content="txt('Group')" />
          <option py:attrs="dict(selected=(None, 'selected')[not group_rights])"
                  value="0"
                  py:content="txt('User')" />
        </select>
        </td>
      </tr>
    </table>

    <h3 py:content="txt('Things That The Users In This Group May Do')" />
    <iframe id='permission_tree' src="$url" style='border: 0' width="100%" height="30">
    </iframe>

    <h3 py:content="txt('Unconfirmed Permission Changes')" />
    <div id='changelog'><i py:content="txt('No permissions changed.')" /></div>
    </td>
  </tr>
  <tr>
    <td>
    <table py:if="group.get_id() >  0" width="100%">
      <tr>
        <td><input type="submit" class="button" name="group_add" value="Add New Group" /></td>
        <td>&nbsp;</td>
        <td><input type="submit" class="button" name="user_add" value="Add New User" /></td>
      </tr>
    </table>
    </td>
    <td></td>
    <td align="right">
    <table>
      <tr>
        <td><input type="submit" class="button" name="delete" value="Delete Group" /></td>
        <td>&nbsp;</td>
        <td><input type="submit" class="button" name="save" value="Apply Changes" /></td>
      </tr>
    </table>
    </td>
  </tr>
</table>
</form>
</div>
